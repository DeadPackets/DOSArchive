---
import type { Program } from '../data/programs';

interface Props {
  program: Program;
}

const { program } = Astro.props;
const base = import.meta.env.BASE_URL;
const href = `${base}/program/${program.id}`;
---

<article
  class="program-card card-glow"
  data-year={program.year}
  data-language={program.language}
  data-category={program.category}
  data-tags={program.tags.join(',')}
  data-title={program.title.toLowerCase()}
  data-description={program.description.toLowerCase()}
>
  <a href={href} class="card-image-link img-scanlines" aria-hidden="true" tabindex="-1">
    <img
      src={`${base}/images/${program.image}`}
      alt={`Screenshot of ${program.title}`}
      loading="lazy"
      width="320"
      height="200"
    />
  </a>

  <div class="card-body">
    <div class="card-badges">
      <span class="badge badge-year">{program.year}</span>
      <span class="badge badge-lang">{program.language}</span>
    </div>

    <h3 class="card-title">
      <a href={href}>{program.title}</a>
    </h3>
    <p class="card-subtitle">{program.subtitle}</p>
    <p class="card-desc">{program.description.slice(0, 150)}{program.description.length > 150 ? '...' : ''}</p>

    <a href={href} class="btn btn-sm">
      <span aria-hidden="true">&gt;</span> RUN
    </a>
  </div>
</article>

<style>
  .program-card {
    background: var(--color-card);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: transform 0.25s var(--ease-out), border-color 0.3s ease, box-shadow 0.3s ease;
  }

  .program-card:hover {
    transform: translateY(-2px);
  }

  .card-image-link {
    display: block;
    aspect-ratio: 16 / 10;
    overflow: hidden;
    background: #000;
    border-bottom: 1px solid var(--color-border);
  }

  .card-image-link img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: opacity 0.2s ease;
  }

  .program-card:hover .card-image-link img {
    opacity: 0.85;
  }

  .card-body {
    padding: 1rem 1.15rem 1.15rem;
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .card-badges {
    display: flex;
    gap: 0.4rem;
    margin-bottom: 0.65rem;
  }

  .card-title {
    font-size: 1.3rem;
    margin-bottom: 0.15rem;
  }

  .card-title a {
    color: inherit;
    text-decoration: none;
  }

  .card-title a:hover {
    text-shadow: var(--glow-md);
  }

  .card-subtitle {
    font-size: 0.78rem;
    color: var(--color-text-muted);
    margin-bottom: 0.6rem;
  }

  .card-desc {
    font-size: 0.8rem;
    color: var(--color-text);
    line-height: 1.55;
    flex: 1;
    margin-bottom: 1rem;
  }
</style>
